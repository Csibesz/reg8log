<?phpif(ini_get('register_globals')) exit("<center><h3>Error: Turn that damned register globals off!</h3></center>");if(!isset($parent_page)) exit("<center><h3>Error: Direct access denied!</h3></center>");if($ip_block_threshold==-1  and $ip_captcha_threshold==-1) return;if(!isset($_COOKIE['reg8log_ip_incorrect_logins'])) return;require_once $index_dir.'include/func/func_inet.php';$ip=$reg8log_db->quote_smart(inet_pton2($_SERVER['REMOTE_ADDR']));require $index_dir.'include/code/chekc_ip_incorrect_logins_num_decs.php';if($limit<1) return;$autos=explode(',', $_COOKIE['reg8log_ip_incorrect_logins']);$tmp37=$autos;for($i=0; $i<count($tmp37); $i++) if(!is_numeric($autos[$i])) unset($autos[$i]);$tmp37=$autos;$autos=implode(',', $autos);$query='delete from `ip_incorrect_logins` where `auto` in '."($autos)".' and `ip`='.$ip.' and `account_auto`='.$user->user_info['auto']." limit $limit";$reg8log_db->query($query);$affected_rows=mysql_affected_rows();if($affected_rows==count($tmp37)) setcookie('reg8log_ip_incorrect_logins', false, mktime(12,0,0,1, 1, 1990), '/', null, $https, true);if($affected_rows<1) return;$query='insert into `ip_incorrect_logins_decs` (`ip`, `account_auto`, `num_dec`, `timestamp`) values '."($ip, {$user->user_info['auto']}, $affected_rows, $req_time)";$reg8log_db->query($query);require_once $index_dir.'include/config/config_cleanup.php';if(mt_rand(1, floor(1/$cleanup_probability))==1) require $index_dir.'include/code/cleanup/code_ip_incorrect_logins_decs_expired_cleanup.php';if(mt_rand(1, floor(1/$cleanup_probability))==1) require $index_dir.'include/code/cleanup/code_ip_incorrect_logins_decs_size_cleanup.php';?>